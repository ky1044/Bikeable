{"ast":null,"code":"var _jsxFileName = \"/Users/keny/Desktop/Programming/Bikeable/frontend/src/App.js\";\nimport React from 'react';\nimport './App.css';\nimport Header from \"./components/Header\";\nimport Dashboard from \"./components/Dashboard\";\nimport Stations from \"./components/Stations\";\nimport Footer from \"./components/Footer\";\nimport Desktop from \"./components/Desktop\";\nvar API_URL = \"http://flask-env.eba-zsqmm3jt.us-east-2.elasticbeanstalk.com/\"; // API_URL  = \"\"\n\nclass App extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      selectedLocation: \"Union Square Park\",\n      selectedLocationLatitude: 40.7359,\n      selectedLocationLongitude: -73.9911,\n      locationCoordinates: {\n        \"Washington Square Park\": {\n          latitude: 40.7308,\n          longitude: -73.9973\n        },\n        \"Union Square Park\": {\n          latitude: 40.7359,\n          longitude: -73.9911\n        },\n        \"Times Square\": {\n          latitude: 40.7580,\n          longitude: -73.9911\n        },\n        \"Bowling Green\": {\n          latitude: 40.7050,\n          longitude: -74.0137\n        },\n        \"The MET\": {\n          latitude: 40.7794,\n          longitude: -73.9632\n        },\n        \"Penn Station\": {\n          latitude: 40.7506,\n          longitude: -73.9935\n        }\n      },\n      numStations: 10,\n      time: \"\",\n      date: \"\",\n      weather: \"\",\n      temperature: \"\",\n      stations: [],\n      initialBikeCount: {},\n      status: {},\n      showInfo: {},\n      dayLog: {},\n      weekLog: {},\n      hasLoaded: false,\n      showMap: false,\n      mapStation: null,\n      loadTime: null,\n      updateTime: null,\n      mapClickTime: null,\n      timeSinceUpdate: null,\n      timeSinceLoad: null,\n      timeSinceMapClick: null,\n      windowHeight: 0,\n      windowWidth: 0,\n      view: null\n    };\n    this.getStationStatus = this.getStationStatus.bind(this);\n    this.setStationStatus = this.setStationStatus.bind(this);\n    this.getStationDayLog = this.getStationDayLog.bind(this);\n    this.setStationDayLog = this.setStationDayLog.bind(this);\n    this.getStationWeekLog = this.getStationWeekLog.bind(this);\n    this.setStationWeekLog = this.setStationWeekLog.bind(this);\n    this.handleMapLocationChange = this.handleMapLocationChange.bind(this);\n    this.handleLocationChange = this.handleLocationChange.bind(this);\n    this.handleMapToggle = this.handleMapToggle.bind(this);\n    this.handleMapClick = this.handleMapClick.bind(this);\n    this.handleShowChange = this.handleShowChange.bind(this);\n    this.loadMoreStations = this.loadMoreStations.bind(this);\n    this.updateWindowDimensions = this.updateWindowDimensions.bind(this);\n  }\n\n  getStationStatus() {\n    fetch(`${API_URL}stationstatus/${this.state.numStations}/${this.state.selectedLocationLatitude},${this.state.selectedLocationLongitude}`).then(res => res.json()).then(data => this.setStationStatus(data));\n  }\n\n  setStationStatus(data) {\n    let stationList = data.stationStatus.map(station => {\n      return station.id;\n    });\n\n    if (!this.state.loadTime) {\n      this.setState({\n        loadTime: Date.now()\n      });\n    }\n\n    this.setState({\n      updateTime: Date.now(),\n      date: data.date,\n      time: data.time,\n      temperature: data.weatherTemperature,\n      weather: data.weatherDescription\n    });\n\n    for (let stationI = 0; stationI < stationList.length; stationI++) {\n      this.setState(prevState => ({\n        status: { ...prevState.status,\n          [stationList[stationI]]: data.stationStatus[stationI]\n        }\n      }));\n\n      if (!(stationList[stationI] in this.state.initialBikeCount)) {\n        this.setState(prevState => ({\n          showInfo: { ...prevState.showInfo,\n            [stationList[stationI]]: false\n          },\n          initialBikeCount: { ...prevState.initialBikeCount,\n            [stationList[stationI]]: this.state.status[stationList[stationI]].bikes\n          }\n        }));\n      } //  this.getStationDayLog(stationList[stationI])\n      //  this.getStationWeekLog(stationList[stationI])       \n\n    }\n\n    this.setState({\n      stations: stationList\n    });\n    this.setState({\n      hasLoaded: true\n    });\n    console.log(\"updated station status\");\n  }\n\n  getStationDayLog(stationID) {\n    fetch(`${API_URL}stationlog/${stationID}`).then(res => res.json()).then(data => this.setStationDayLog(data, stationID)); // console.log(\"updated station \"+stationID+\" logs\")\n  }\n\n  setStationDayLog(data, stationID) {\n    this.setState(prevState => ({\n      dayLog: { ...prevState.dayLog,\n        [stationID]: data.stationLog\n      }\n    }));\n  }\n\n  getStationWeekLog(stationID) {\n    fetch(`${API_URL}stationlogweek/${stationID}`).then(res => res.json()).then(data => this.setStationWeekLog(data, stationID));\n  }\n\n  setStationWeekLog(data, stationID) {\n    this.setState(prevState => ({\n      weekLog: { ...prevState.weekLog,\n        [stationID]: data.stationLog\n      }\n    })); // console.log(this.state.weekLog[stationID])\n  }\n\n  async handleMapLocationChange(lat, lon) {\n    await this.setState(prevState => ({\n      selectedLocation: \"Custom Location\",\n      selectedLocationLatitude: lat.toFixed(5),\n      selectedLocationLongitude: lon.toFixed(5),\n      numStations: 10,\n      stations: [],\n      initialBikeCount: {},\n      status: {},\n      showInfo: {},\n      dayLog: {},\n      weekLog: {},\n      hasLoaded: false,\n      mapStation: null,\n      loadTime: null,\n      updateTime: null,\n      mapClickTime: null,\n      timeSinceUpdate: null,\n      timeSinceLoad: null,\n      timeSinceMapClick: null\n    }));\n    this.getStationStatus();\n  }\n\n  async handleLocationChange(name) {\n    await this.setState(prevState => ({\n      selectedLocation: name,\n      selectedLocationLatitude: prevState.locationCoordinates[name].latitude,\n      selectedLocationLongitude: prevState.locationCoordinates[name].longitude,\n      numStations: 10,\n      stations: [],\n      initialBikeCount: {},\n      status: {},\n      showInfo: {},\n      dayLog: {},\n      weekLog: {},\n      hasLoaded: false,\n      mapStation: null,\n      loadTime: null,\n      updateTime: null,\n      mapClickTime: null,\n      timeSinceUpdate: null,\n      timeSinceLoad: null,\n      timeSinceMapClick: null\n    }));\n    this.getStationStatus();\n  }\n\n  handleMapToggle() {\n    this.setState(prevState => ({\n      showMap: !prevState.showMap\n    }));\n  }\n\n  async handleMapClick(event, id) {\n    await this.setState(prevState => ({\n      mapStation: id,\n      mapClickTime: Date.now(),\n      showInfo: { ...prevState.showInfo,\n        [id]: true\n      }\n    }));\n    this.getStationDayLog(id);\n    this.getStationWeekLog(id);\n  }\n\n  async handleShowChange(id) {\n    await this.setState(prevState => {\n      const newShow = !prevState.showInfo[id];\n      return {\n        showInfo: { ...prevState.showInfo,\n          [id]: newShow\n        }\n      };\n    });\n    this.getStationDayLog(id);\n    this.getStationWeekLog(id);\n  }\n\n  async loadMoreStations() {\n    await this.setState(prevState => ({\n      numStations: prevState.numStations + 10\n    }));\n    this.getStationStatus();\n  }\n\n  updateWindowDimensions() {\n    this.setState(prevState => {\n      const nextShowMap = prevState.showMap || prevState.view !== \"Desktop\" && window.innerWidth > 820;\n      return {\n        windowWidth: window.innerWidth,\n        windowHeight: window.innerHeight,\n        view: window.innerWidth > 820 ? \"Desktop\" : \"Mobile\",\n        showMap: nextShowMap\n      };\n    });\n  }\n\n  componentDidMount() {\n    this.updateWindowDimensions();\n    window.addEventListener('resize', this.updateWindowDimensions);\n    this.setState({\n      showMap: window.innerWidth > 820 ? true : false\n    });\n    this.getStationStatus();\n    setInterval(() => this.setState(prevState => ({\n      timeSinceUpdate: Date.now() - prevState.updateTime,\n      timeSinceLoad: Date.now() - prevState.loadTime\n    })), 100);\n    setInterval(() => this.setState(prevState => ({\n      timeSinceMapClick: Date.now() - prevState.mapClickTime\n    })), 10);\n    setInterval(() => this.getStationStatus(), 30000);\n  }\n\n  render() {\n    if (this.state.view === \"Desktop\") {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 309,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(Header, Object.assign({}, this.state, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 310,\n          columnNumber: 9\n        }\n      })), /*#__PURE__*/React.createElement(Desktop, Object.assign({}, this.state, {\n        handleLocationChange: this.handleLocationChange,\n        handleMapClick: this.handleMapClick,\n        handleMapLocationChange: this.handleMapLocationChange,\n        handleMapToggle: this.handleMapToggle,\n        handleShowChange: this.handleShowChange,\n        loadMoreStations: this.loadMoreStations,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 311,\n          columnNumber: 9\n        }\n      })), /*#__PURE__*/React.createElement(Footer, Object.assign({}, this.state, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 312,\n          columnNumber: 9\n        }\n      })));\n    } else {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 317,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(Header, Object.assign({}, this.state, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 318,\n          columnNumber: 9\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          width: \"min(90vw,800px)\",\n          margin: \"auto\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 319,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(Dashboard, Object.assign({}, this.state, {\n        handleLocationChange: this.handleLocationChange,\n        handleMapClick: this.handleMapClick,\n        handleMapLocationChange: this.handleMapLocationChange,\n        handleMapToggle: this.handleMapToggle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 320,\n          columnNumber: 9\n        }\n      })), /*#__PURE__*/React.createElement(Stations, Object.assign({}, this.state, {\n        handleShowChange: this.handleShowChange,\n        loadMoreStations: this.loadMoreStations,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 321,\n          columnNumber: 9\n        }\n      }))), /*#__PURE__*/React.createElement(Footer, Object.assign({}, this.state, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 323,\n          columnNumber: 9\n        }\n      })));\n    }\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/keny/Desktop/Programming/Bikeable/frontend/src/App.js"],"names":["React","Header","Dashboard","Stations","Footer","Desktop","API_URL","App","Component","constructor","state","selectedLocation","selectedLocationLatitude","selectedLocationLongitude","locationCoordinates","latitude","longitude","numStations","time","date","weather","temperature","stations","initialBikeCount","status","showInfo","dayLog","weekLog","hasLoaded","showMap","mapStation","loadTime","updateTime","mapClickTime","timeSinceUpdate","timeSinceLoad","timeSinceMapClick","windowHeight","windowWidth","view","getStationStatus","bind","setStationStatus","getStationDayLog","setStationDayLog","getStationWeekLog","setStationWeekLog","handleMapLocationChange","handleLocationChange","handleMapToggle","handleMapClick","handleShowChange","loadMoreStations","updateWindowDimensions","fetch","then","res","json","data","stationList","stationStatus","map","station","id","setState","Date","now","weatherTemperature","weatherDescription","stationI","length","prevState","bikes","console","log","stationID","stationLog","lat","lon","toFixed","name","event","newShow","nextShowMap","window","innerWidth","innerHeight","componentDidMount","addEventListener","setInterval","render","width","margin"],"mappings":"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","sourcesContent":["import React from 'react';\nimport './App.css';\n\nimport Header from \"./components/Header\"\nimport Dashboard from \"./components/Dashboard\"\nimport Stations from \"./components/Stations\"\nimport Footer from \"./components/Footer\"\n\n\nimport Desktop from \"./components/Desktop\"\n\nvar API_URL = \"http://flask-env.eba-zsqmm3jt.us-east-2.elasticbeanstalk.com/\"\n// API_URL  = \"\"\n\nclass App extends React.Component{\n  constructor(){\n    super()\n    this.state = {\n\n      selectedLocation:\"Union Square Park\",\n      selectedLocationLatitude:40.7359,\n      selectedLocationLongitude:-73.9911,\n      locationCoordinates:{\n        \"Washington Square Park\":{latitude :40.7308,longitude:-73.9973},\n        \"Union Square Park\":{latitude:40.7359, longitude:-73.9911},\n        \"Times Square\":{latitude:40.7580,longitude:-73.9911},\n        \"Bowling Green\":{latitude:40.7050, longitude:-74.0137},\n        \"The MET\":{latitude:40.7794, longitude:-73.9632},\n        \"Penn Station\":{latitude:40.7506,longitude:-73.9935},\n      },\n      numStations:10,\n\n      time:\"\",\n      date:\"\",\n      weather:\"\",\n      temperature:\"\",\n\n      stations:[],\n      initialBikeCount:{},\n      status:{},\n      showInfo:{},\n      dayLog :{},\n      weekLog :{},\n      \n      hasLoaded:false,\n\n      showMap:false,\n      mapStation:null,\n      \n      loadTime: null,\n      updateTime :null,\n      mapClickTime:null,\n      timeSinceUpdate:null,\n      timeSinceLoad:null,\n      timeSinceMapClick:null,\n\n      windowHeight:0,\n      windowWidth:0,\n      view:null\n\n      \n    }\n    this.getStationStatus = this.getStationStatus.bind(this);\n    this.setStationStatus = this.setStationStatus.bind(this);\n\n    this.getStationDayLog = this.getStationDayLog.bind(this);\n    this.setStationDayLog = this.setStationDayLog.bind(this);\n\n    this.getStationWeekLog = this.getStationWeekLog.bind(this);\n    this.setStationWeekLog = this.setStationWeekLog.bind(this);\n\n    this.handleMapLocationChange = this.handleMapLocationChange.bind(this);\n    this.handleLocationChange = this.handleLocationChange.bind(this);\n    this.handleMapToggle = this.handleMapToggle.bind(this);\n    this.handleMapClick = this.handleMapClick.bind(this);\n    this.handleShowChange = this.handleShowChange.bind(this);\n    this.loadMoreStations = this.loadMoreStations.bind(this);\n\n    this.updateWindowDimensions = this.updateWindowDimensions.bind(this);\n  }\n\n  getStationStatus(){\n    fetch(`${API_URL}stationstatus/${this.state.numStations}/${this.state.selectedLocationLatitude},${this.state.selectedLocationLongitude}`).then(res=>res.json()).then(data=>(\n      this.setStationStatus(data)\n    ))\n    \n  }\n\n  setStationStatus(data){\n\n    let stationList = data.stationStatus.map(station=>{return station.id})\n    \n    if (!this.state.loadTime){\n      this.setState({ \n        loadTime:Date.now()\n       });\n\n     }\n\n     this.setState({\n      updateTime: Date.now(),\n      date:data.date,\n      time: data.time,\n      temperature:data.weatherTemperature,\n      weather: data.weatherDescription\n      \n    })\n         \n\n     for (let stationI = 0; stationI < stationList.length; stationI++){\n      this.setState(prevState=>({ \n        status:{\n          ...prevState.status,\n          [stationList[stationI]]:data.stationStatus[stationI]\n          \n        }\n       }));\n      \n       if (!(stationList[stationI] in this.state.initialBikeCount)){\n        this.setState(prevState=>({ \n          showInfo:{\n            ...prevState.showInfo,\n            [stationList[stationI]]:false\n          },\n          initialBikeCount:{\n            ...prevState.initialBikeCount,\n            [stationList[stationI]]:this.state.status[stationList[stationI]].bikes\n          },\n\n          }));\n      }\n      //  this.getStationDayLog(stationList[stationI])\n      //  this.getStationWeekLog(stationList[stationI])       \n     }\n     this.setState({\n      stations:stationList\n\n    })\n     \n     this.setState({ \n      hasLoaded:true\n     });\n     console.log(\"updated station status\")\n  }\n\n  getStationDayLog(stationID){\n    fetch(`${API_URL}stationlog/${stationID}`).then(res=>res.json()).then(data=>(\n      this.setStationDayLog(data,stationID)\n    ))\n    // console.log(\"updated station \"+stationID+\" logs\")\n  }\n\n  setStationDayLog(data,stationID){\n\n      this.setState(prevState=>({\n        dayLog:{\n          ...prevState.dayLog,\n          [stationID]:data.stationLog\n        }\n      }))\n    \n  }\n\n  getStationWeekLog(stationID){\n    fetch(`${API_URL}stationlogweek/${stationID}`).then(res=>res.json()).then(data=>(\n      this.setStationWeekLog(data,stationID)\n    ))\n  }\n\n  setStationWeekLog(data,stationID){\n\n      this.setState(prevState=>({\n        weekLog:{\n          ...prevState.weekLog,\n          [stationID]:data.stationLog\n        }\n      }))\n      // console.log(this.state.weekLog[stationID])\n    \n  }\n\n  async handleMapLocationChange(lat,lon){\n    await this.setState( prevState=>({\n      selectedLocation: \"Custom Location\",\n      selectedLocationLatitude:lat.toFixed(5),\n      selectedLocationLongitude:lon.toFixed(5),\n\n      numStations:10,\n      stations:[],\n      initialBikeCount:{},\n      status:{},\n      showInfo:{},\n      dayLog :{},\n      weekLog :{},\n      \n      hasLoaded:false,\n\n\n      mapStation:null,\n      \n      loadTime: null,\n      updateTime :null,\n      mapClickTime:null,\n      timeSinceUpdate:null,\n      timeSinceLoad:null,\n      timeSinceMapClick:null,\n    }))\n    this.getStationStatus()\n\n  }\n\n  async handleLocationChange(name){\n    await this.setState( prevState=>({\n      selectedLocation: name,\n      selectedLocationLatitude:prevState.locationCoordinates[name].latitude,\n      selectedLocationLongitude:prevState.locationCoordinates[name].longitude,\n      numStations:10,\n      stations:[],\n      initialBikeCount:{},\n      status:{},\n      showInfo:{},\n      dayLog :{},\n      weekLog :{},\n      \n      hasLoaded:false,\n\n      mapStation:null,\n      \n      loadTime: null,\n      updateTime :null,\n      mapClickTime:null,\n      timeSinceUpdate:null,\n      timeSinceLoad:null,\n      timeSinceMapClick:null,\n    }))\n    this.getStationStatus()\n  }\n\n  handleMapToggle(){\n    this.setState( prevState =>(\n      {showMap:!prevState.showMap}\n     ))\n  }\n\n  async handleMapClick(event,id){\n    await this.setState( prevState=>({\n        mapStation:id,\n        mapClickTime:Date.now(),\n        showInfo:{\n          ...prevState.showInfo,\n          [id]:true\n        } }\n      \n\n    ))\n    this.getStationDayLog(id)\n    this.getStationWeekLog(id) \n    \n  }\n\n  async handleShowChange(id){\n    await this.setState( prevState =>{\n      const newShow = !prevState.showInfo[id]\n      return { \n      showInfo:{\n        ...prevState.showInfo,\n        [id]:newShow\n      }\n     }})\n    this.getStationDayLog(id)\n    this.getStationWeekLog(id)   \n  }\n\n  async loadMoreStations(){\n    await this.setState(prevState=>({\n      numStations: prevState.numStations+10\n    }))\n    this.getStationStatus()\n  }\n\n  updateWindowDimensions() {\n    this.setState(prevState=>{\n      const nextShowMap = prevState.showMap || (prevState.view!==\"Desktop\"&&window.innerWidth>820);\n      return {\n        windowWidth: window.innerWidth, \n      windowHeight: window.innerHeight,\n      view:window.innerWidth>820?\"Desktop\":\"Mobile\",\n      showMap:nextShowMap\n    }});\n    \n      \n     \n  }\n\n  componentDidMount() {\n    this.updateWindowDimensions();\n    window.addEventListener('resize', this.updateWindowDimensions);\n    this.setState({showMap:window.innerWidth>820?true:false})\n    this.getStationStatus()\n    setInterval(() => this.setState(prevState=>({ timeSinceUpdate: Date.now()-prevState.updateTime,timeSinceLoad:Date.now()-prevState.loadTime})), 100)\n    setInterval(() => this.setState(prevState=>({timeSinceMapClick:Date.now()-prevState.mapClickTime})), 10)\n    setInterval(() => this.getStationStatus(), 30000)\n    \n      \n  }\n\n  render(){\n    if (this.state.view===\"Desktop\"){return (\n      <div>\n        <Header {...this.state}/>\n        <Desktop {...this.state} handleLocationChange = {this.handleLocationChange} handleMapClick = {this.handleMapClick} handleMapLocationChange = {this.handleMapLocationChange} handleMapToggle = {this.handleMapToggle} handleShowChange = {this.handleShowChange} loadMoreStations = {this.loadMoreStations}/>\n        <Footer {...this.state}/>\n        \n      </div>\n    );}\n    else{return(\n      <div>\n        <Header {...this.state}/>\n        <div style={{width:\"min(90vw,800px)\",margin:\"auto\"}}>\n        <Dashboard{...this.state} handleLocationChange = {this.handleLocationChange} handleMapClick = {this.handleMapClick} handleMapLocationChange = {this.handleMapLocationChange}  handleMapToggle = {this.handleMapToggle}/>\n        <Stations{...this.state} handleShowChange = {this.handleShowChange} loadMoreStations = {this.loadMoreStations}/>\n        </div>\n        <Footer {...this.state}/>\n      </div>\n    )\n      \n    }\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}