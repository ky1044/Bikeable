{"ast":null,"code":"var _jsxFileName = \"/Users/keny/Desktop/Programming/Bikeable/frontend/src/App.js\";\nimport React from 'react';\nimport './App.css';\nimport Header from \"./components/Header\";\nimport LocationCard from \"./components/LocationCard\";\nimport StationCard from \"./components/StationCard\";\nimport Footer from \"./components/Footer\";\n\nclass App extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      warnings: null,\n      selectedLocation: \"Washington Square Park\",\n      locationCoordinates: {\n        \"Washington Square Park\": {\n          latitude: 40.7308,\n          longitude: 73.9973\n        },\n        \"Union Square Park\": {\n          latitude: 40.7359,\n          longitude: 73.9911\n        },\n        \"Times Square\": {\n          latitude: 40.7580,\n          longitude: 73.9911\n        },\n        \"Bowling Green\": {\n          latitude: 40.7050,\n          longitude: 74.0137\n        },\n        \"The MET\": {\n          latitude: 40.7794,\n          longitude: 73.9632\n        },\n        \"Penn Station\": {\n          latitude: 40.7506,\n          longitude: 73.9935\n        }\n      },\n      latitude: 40.7308,\n      longitude: 73.9973,\n      numStations: 5,\n      time: \"\",\n      date: \"\",\n      weather: \"\",\n      temperature: \"\",\n      stations: [],\n      initialBikeCount: {},\n      logBikeCount: {},\n      status: {},\n      log: {},\n      logWeek: {},\n      hasloaded: false,\n      loadTime: null,\n      updateTime: null,\n      timeSinceUpdate: null,\n      timeSinceLoad: null,\n      showInfo: {}\n    };\n    this.getStationStatus = this.getStationStatus.bind(this);\n    this.setStationStatus = this.setStationStatus.bind(this);\n    this.handleShowChange = this.handleShowChange.bind(this);\n    this.getStationLog = this.getStationLog.bind(this);\n    this.setStationLog = this.setStationLog.bind(this);\n    this.getStationLogWeek = this.getStationLogWeek.bind(this);\n    this.setStationLogWeek = this.setStationLogWeek.bind(this);\n    this.loadMoreStations = this.loadMoreStations.bind(this);\n    this.handleLocationChange = this.handleLocationChange.bind(this);\n  }\n\n  getStationStatus() {\n    fetch(`stationstatus/${this.state.numStations}/${this.state.locationCoordinates[this.state.selectedLocation].latitude},${this.state.locationCoordinates[this.state.selectedLocation].longitude}`).then(res => res.json()).then(data => this.setStationStatus(data));\n  }\n\n  setStationStatus(data) {\n    let stationList = data.stationStatus.map(station => {\n      return station.id;\n    });\n\n    if (!this.state.loadTime) {\n      this.setState({\n        loadTime: Date.now()\n      });\n    }\n\n    this.setState({\n      updateTime: Date.now(),\n      date: data.date,\n      time: data.time,\n      temperature: weatherTemperature,\n      weather: data.weatherDescription\n    });\n\n    for (let stationI = 0; stationI < stationList.length; stationI++) {\n      this.setState(prevState => ({\n        status: { ...prevState.status,\n          [stationList[stationI]]: data.stationStatus[stationI]\n        }\n      }));\n      console.log(data);\n\n      if (stationList[stationI] in this.state.initialBikeCount) {\n        const prevStationState = this.state.logBikeCount[stationList[stationI]].concat([this.state.status[stationList[stationI]].bikes]);\n        this.setState(prevState => ({\n          logBikeCount: { ...prevState.logBikeCount,\n            [stationList[stationI]]: prevStationState\n          }\n        }));\n      } else {\n        this.setState(prevState => ({\n          showInfo: { ...prevState.showInfo,\n            [stationList[stationI]]: false\n          },\n          initialBikeCount: { ...prevState.initialBikeCount,\n            [stationList[stationI]]: this.state.status[stationList[stationI]].bikes\n          },\n          logBikeCount: { ...prevState.logBikeCount,\n            [stationList[stationI]]: [this.state.status[stationList[stationI]].bikes]\n          }\n        }));\n      }\n\n      this.getStationLog(stationList[stationI]);\n      this.getStationLogWeek(stationList[stationI]);\n    }\n\n    this.setState({\n      stations: stationList\n    });\n    this.setState({\n      hasloaded: true\n    });\n    console.log(\"updated station status\");\n  }\n\n  getStationLog(stationID) {\n    fetch(`stationlog/${stationID}`).then(res => res.json()).then(data => this.setStationLog(data, stationID)); // console.log(\"updated station \"+stationID+\" logs\")\n  }\n\n  setStationLog(data, stationID) {\n    this.setState(prevState => ({\n      log: { ...prevState.log,\n        [stationID]: data.stationLog\n      }\n    }));\n  }\n\n  getStationLogWeek(stationID) {\n    fetch(`stationlogweek/${stationID}`).then(res => res.json()).then(data => this.setStationLogWeek(data, stationID)); // console.log(\"updated station \"+stationID+\" logs\")\n  }\n\n  setStationLogWeek(data, stationID) {\n    this.setState(prevState => ({\n      logWeek: { ...prevState.logWeek,\n        [stationID]: data.stationLog\n      }\n    })); // console.log(this.state.logWeek[stationID])\n  }\n\n  handleShowChange(id) {\n    this.setState(prevState => {\n      const newShow = !prevState.showInfo[id];\n      return {\n        showInfo: { ...prevState.showInfo,\n          [id]: newShow\n        }\n      };\n    });\n  }\n\n  async handleLocationChange(name) {\n    await this.setState({\n      selectedLocation: name,\n      numStations: 5,\n      stations: [],\n      initialBikeCount: {},\n      logBikeCount: {},\n      status: {},\n      log: {},\n      logWeek: {},\n      hasloaded: false,\n      loadTime: null,\n      updateTime: null,\n      timeSinceUpdate: null,\n      timeSinceLoad: null,\n      showInfo: {}\n    });\n    this.getStationStatus();\n  }\n\n  async loadMoreStations() {\n    await this.setState(prevState => ({\n      numStations: prevState.numStations + 5\n    }));\n    this.getStationStatus();\n  }\n\n  componentDidMount() {\n    this.getStationStatus();\n    setInterval(() => this.setState(prevState => ({\n      timeSinceUpdate: Date.now() - prevState.updateTime,\n      timeSinceLoad: Date.now() - prevState.loadTime\n    })), 100);\n    setInterval(() => this.getStationStatus(), 30000);\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Header, Object.assign({}, this.state, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 9\n      }\n    })), !this.state.hasloaded && /*#__PURE__*/React.createElement(\"h2\", {\n      style: {\n        textAlign: \"center\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 33\n      }\n    }, \"Loading...\"), this.state.hasloaded && /*#__PURE__*/React.createElement(\"div\", {\n      className: \"general-info-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 32\n      }\n    }, /*#__PURE__*/React.createElement(\"h3\", {\n      style: {\n        float: \"left\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 75\n      }\n    }, this.state.time, \", \", this.state.date), /*#__PURE__*/React.createElement(\"h3\", {\n      style: {\n        float: \"right\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 143\n      }\n    }, this.state.temperature, \", \", this.state.weather)), /*#__PURE__*/React.createElement(LocationCard, Object.assign({}, this.state, {\n      handleLocationChange: this.handleLocationChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 9\n      }\n    })), this.state.stations.map((id, index) => /*#__PURE__*/React.createElement(StationCard, Object.assign({\n      key: id,\n      id: id,\n      index: index\n    }, this.state, {\n      handleShowChange: this.handleShowChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 11\n      }\n    }))), this.state.hasloaded && this.state.stations.length < 30 && /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 69\n      }\n    }, /*#__PURE__*/React.createElement(\"h3\", {\n      className: \"load-more\",\n      onClick: () => this.loadMoreStations(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 74\n      }\n    }, \"Load More Stations\"), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 164\n      }\n    })), this.state.hasloaded && /*#__PURE__*/React.createElement(Footer, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 247,\n        columnNumber: 32\n      }\n    }));\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/keny/Desktop/Programming/Bikeable/frontend/src/App.js"],"names":["React","Header","LocationCard","StationCard","Footer","App","Component","constructor","state","warnings","selectedLocation","locationCoordinates","latitude","longitude","numStations","time","date","weather","temperature","stations","initialBikeCount","logBikeCount","status","log","logWeek","hasloaded","loadTime","updateTime","timeSinceUpdate","timeSinceLoad","showInfo","getStationStatus","bind","setStationStatus","handleShowChange","getStationLog","setStationLog","getStationLogWeek","setStationLogWeek","loadMoreStations","handleLocationChange","fetch","then","res","json","data","stationList","stationStatus","map","station","id","setState","Date","now","weatherTemperature","weatherDescription","stationI","length","prevState","console","prevStationState","concat","bikes","stationID","stationLog","newShow","name","componentDidMount","setInterval","render","textAlign","float","index"],"mappings":"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","sourcesContent":["import React from 'react';\nimport './App.css';\n\nimport Header from \"./components/Header\"\nimport LocationCard from \"./components/LocationCard\"\nimport StationCard from \"./components/StationCard\"\nimport Footer from \"./components/Footer\"\n\nclass App extends React.Component{\n  constructor(){\n    super()\n    this.state = {\n      warnings:null,\n\n      selectedLocation:\"Washington Square Park\",\n      locationCoordinates:{\n        \"Washington Square Park\":{latitude :40.7308,longitude:73.9973},\n        \"Union Square Park\":{latitude:40.7359, longitude:73.9911},\n        \"Times Square\":{latitude:40.7580,longitude:73.9911},\n        \"Bowling Green\":{latitude:40.7050, longitude:74.0137},\n        \"The MET\":{latitude:40.7794, longitude:73.9632},\n        \"Penn Station\":{latitude:40.7506,longitude:73.9935}\n      },\n      latitude :40.7308,\n      longitude:73.9973,\n      numStations:5,\n\n      time:\"\",\n      date:\"\",\n\n      weather:\"\",\n      temperature:\"\",\n\n      stations:[],\n      initialBikeCount:{},\n      logBikeCount:{},\n      status:{},\n      log :{},\n      logWeek :{},\n      \n      hasloaded:false,\n\n      loadTime: null,\n      updateTime :null,\n      timeSinceUpdate:null,\n      timeSinceLoad:null,\n      \n      showInfo:{}\n    }\n    this.getStationStatus = this.getStationStatus.bind(this);\n    this.setStationStatus = this.setStationStatus.bind(this);\n    this.handleShowChange = this.handleShowChange.bind(this);\n    this.getStationLog = this.getStationLog.bind(this);\n    this.setStationLog = this.setStationLog.bind(this);\n    this.getStationLogWeek = this.getStationLogWeek.bind(this);\n    this.setStationLogWeek = this.setStationLogWeek.bind(this);\n    this.loadMoreStations = this.loadMoreStations.bind(this);\n    this.handleLocationChange = this.handleLocationChange.bind(this);\n\n    \n  }\n\n  getStationStatus(){\n    fetch(`stationstatus/${this.state.numStations}/${this.state.locationCoordinates[this.state.selectedLocation].latitude},${this.state.locationCoordinates[this.state.selectedLocation].longitude}`).then(res=>res.json()).then(data=>(\n      this.setStationStatus(data)\n    ))\n  }\n  setStationStatus(data){\n\n    let stationList = data.stationStatus.map(station=>{return station.id})\n    \n    if (!this.state.loadTime){\n      this.setState({ \n        loadTime:Date.now()\n       });\n\n     }\n\n     this.setState({\n      updateTime: Date.now(),\n      date:data.date,\n      time: data.time,\n      temperature:weatherTemperature,\n      weather: data.weatherDescription\n      \n    })\n         \n\n     for (let stationI = 0; stationI < stationList.length; stationI++){\n      this.setState(prevState=>({ \n        status:{\n          ...prevState.status,\n          [stationList[stationI]]:data.stationStatus[stationI]\n          \n        }\n       }));\n       console.log(data)\n      \n       if (stationList[stationI] in this.state.initialBikeCount){\n         const prevStationState = this.state.logBikeCount[stationList[stationI]].concat([this.state.status[stationList[stationI]].bikes])\n        this.setState(prevState=>({ \n          logBikeCount:{\n            ...prevState.logBikeCount,\n            [stationList[stationI]]:prevStationState\n          }\n         }));\n       }else{\n        this.setState(prevState=>({ \n          showInfo:{\n            ...prevState.showInfo,\n            [stationList[stationI]]:false\n          },\n          initialBikeCount:{\n            ...prevState.initialBikeCount,\n            [stationList[stationI]]:this.state.status[stationList[stationI]].bikes\n          },\n          logBikeCount:{\n            ...prevState.logBikeCount,\n            [stationList[stationI]]:[this.state.status[stationList[stationI]].bikes]\n          }\n         }));\n         \n       }\n       this.getStationLog(stationList[stationI])\n       this.getStationLogWeek(stationList[stationI])\n       \n     }\n     this.setState({\n      stations:stationList\n\n    })\n     \n     this.setState({ \n      hasloaded:true\n     });\n     console.log(\"updated station status\")\n  }\n\n  getStationLog(stationID){\n    fetch(`stationlog/${stationID}`).then(res=>res.json()).then(data=>(\n      this.setStationLog(data,stationID)\n    ))\n    // console.log(\"updated station \"+stationID+\" logs\")\n  }\n\n  setStationLog(data,stationID){\n\n\n      this.setState(prevState=>({\n        log:{\n          ...prevState.log,\n          [stationID]:data.stationLog\n        }\n      }))\n    \n  }\n\n  getStationLogWeek(stationID){\n    fetch(`stationlogweek/${stationID}`).then(res=>res.json()).then(data=>(\n      this.setStationLogWeek(data,stationID)\n    ))\n    // console.log(\"updated station \"+stationID+\" logs\")\n  }\n\n  setStationLogWeek(data,stationID){\n\n      this.setState(prevState=>({\n        logWeek:{\n          ...prevState.logWeek,\n          [stationID]:data.stationLog\n        }\n      }))\n      // console.log(this.state.logWeek[stationID])\n    \n  }\n\n  handleShowChange(id){\n    this.setState( prevState =>{\n      const newShow = !prevState.showInfo[id]\n      return { \n      showInfo:{\n        ...prevState.showInfo,\n        [id]:newShow\n      }\n     }})\n  }\n\n  async handleLocationChange(name){\n    await this.setState( {\n      selectedLocation:name,\n      numStations:5,\n      stations:[],\n      initialBikeCount:{},\n      logBikeCount:{},\n      status:{},\n      log :{},\n      logWeek :{},\n      hasloaded:false,\n      loadTime: null,\n      updateTime :null,\n      timeSinceUpdate:null,\n      timeSinceLoad:null,\n      showInfo:{}\n    })\n    this.getStationStatus()\n  }\n\n  async loadMoreStations(){\n    await this.setState(prevState=>({\n      numStations: prevState.numStations+5\n    }))\n    this.getStationStatus()\n\n  }\n\n  componentDidMount() {\n    this.getStationStatus()\n    setInterval(() => this.setState(prevState=>({ timeSinceUpdate: Date.now()-prevState.updateTime,timeSinceLoad:Date.now()-prevState.loadTime})), 100)\n    setInterval(() => this.getStationStatus(), 30000)\n      \n  }\n\n\n\n  render(){\n\n    return (\n    \n      <div>\n        <Header {...this.state}/>\n        {!this.state.hasloaded&&<h2 style={{textAlign: \"center\"}}>Loading...</h2>}\n        {this.state.hasloaded&&<div className = \"general-info-container\" ><h3 style={{float:\"left\"}}>{this.state.time}, {this.state.date}</h3><h3 style={{float:\"right\"}}>{this.state.temperature}, {this.state.weather}</h3></div>}        \n        <LocationCard {...this.state} handleLocationChange = {this.handleLocationChange} />\n        {this.state.stations.map( (id,index )=>(\n          <StationCard\n          key={id}\n          id = {id}\n          index = {index}\n          {...this.state}\n\n          handleShowChange = {this.handleShowChange}\n          />\n        ) )}\n      \n          {this.state.hasloaded && this.state.stations.length<30 && <div><h3 className = \"load-more\" onClick={()=>this.loadMoreStations() }>Load More Stations</h3><br/></div>}\n\n        {this.state.hasloaded&&<Footer/>}\n\n      </div>\n    );\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}