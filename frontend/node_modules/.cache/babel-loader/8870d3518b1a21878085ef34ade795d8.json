{"ast":null,"code":"import _regeneratorRuntime from\"/Users/keny/Desktop/Programming/Bikeable/frontend/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/keny/Desktop/Programming/Bikeable/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"/Users/keny/Desktop/Programming/Bikeable/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/keny/Desktop/Programming/Bikeable/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/Users/keny/Desktop/Programming/Bikeable/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/keny/Desktop/Programming/Bikeable/frontend/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/keny/Desktop/Programming/Bikeable/frontend/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/keny/Desktop/Programming/Bikeable/frontend/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/keny/Desktop/Programming/Bikeable/frontend/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import'./App.css';import Header from\"./components/Header\";import Dashboard from\"./components/Dashboard\";import Stations from\"./components/Stations\";import Footer from\"./components/Footer\";import Desktop from\"./components/Desktop\";var App=/*#__PURE__*/function(_React$Component){_inherits(App,_React$Component);var _super=_createSuper(App);function App(){var _this;_classCallCheck(this,App);_this=_super.call(this);_this.state={selectedLocation:\"Union Square Park\",selectedLocationLatitude:40.7359,selectedLocationLongitude:-73.9911,locationCoordinates:{\"Washington Square Park\":{latitude:40.7308,longitude:-73.9973},\"Union Square Park\":{latitude:40.7359,longitude:-73.9911},\"Times Square\":{latitude:40.7580,longitude:-73.9911},\"Bowling Green\":{latitude:40.7050,longitude:-74.0137},\"The MET\":{latitude:40.7794,longitude:-73.9632},\"Penn Station\":{latitude:40.7506,longitude:-73.9935}},numStations:10,time:\"\",date:\"\",weather:\"\",temperature:\"\",stations:[],initialBikeCount:{},status:{},showInfo:{},dayLog:{},weekLog:{},hasLoaded:false,showMap:false,mapStation:null,loadTime:null,updateTime:null,mapClickTime:null,timeSinceUpdate:null,timeSinceLoad:null,timeSinceMapClick:null,windowHeight:0,windowWidth:0,view:null};_this.getStationStatus=_this.getStationStatus.bind(_assertThisInitialized(_this));_this.setStationStatus=_this.setStationStatus.bind(_assertThisInitialized(_this));_this.getStationDayLog=_this.getStationDayLog.bind(_assertThisInitialized(_this));_this.setStationDayLog=_this.setStationDayLog.bind(_assertThisInitialized(_this));_this.getStationWeekLog=_this.getStationWeekLog.bind(_assertThisInitialized(_this));_this.setStationWeekLog=_this.setStationWeekLog.bind(_assertThisInitialized(_this));_this.handleMapLocationChange=_this.handleMapLocationChange.bind(_assertThisInitialized(_this));_this.handleLocationChange=_this.handleLocationChange.bind(_assertThisInitialized(_this));_this.handleMapToggle=_this.handleMapToggle.bind(_assertThisInitialized(_this));_this.handleMapClick=_this.handleMapClick.bind(_assertThisInitialized(_this));_this.handleShowChange=_this.handleShowChange.bind(_assertThisInitialized(_this));_this.loadMoreStations=_this.loadMoreStations.bind(_assertThisInitialized(_this));_this.updateWindowDimensions=_this.updateWindowDimensions.bind(_assertThisInitialized(_this));return _this;}_createClass(App,[{key:\"getStationStatus\",value:function getStationStatus(){var _this2=this;fetch(\"stationstatus/\".concat(this.state.numStations,\"/\").concat(this.state.selectedLocationLatitude,\",\").concat(this.state.selectedLocationLongitude)).then(function(res){return res.json();}).then(function(data){return _this2.setStationStatus(data);});}},{key:\"setStationStatus\",value:function setStationStatus(data){var _this3=this;var stationList=data.stationStatus.map(function(station){return station.id;});if(!this.state.loadTime){this.setState({loadTime:Date.now()});}this.setState({updateTime:Date.now(),date:data.date,time:data.time,temperature:data.weatherTemperature,weather:data.weatherDescription});var _loop=function _loop(stationI){_this3.setState(function(prevState){return{status:_objectSpread({},prevState.status,_defineProperty({},stationList[stationI],data.stationStatus[stationI]))};});if(!(stationList[stationI]in _this3.state.initialBikeCount)){_this3.setState(function(prevState){return{showInfo:_objectSpread({},prevState.showInfo,_defineProperty({},stationList[stationI],false)),initialBikeCount:_objectSpread({},prevState.initialBikeCount,_defineProperty({},stationList[stationI],_this3.state.status[stationList[stationI]].bikes))};});}//  this.getStationDayLog(stationList[stationI])\n//  this.getStationWeekLog(stationList[stationI])       \n};for(var stationI=0;stationI<stationList.length;stationI++){_loop(stationI);}this.setState({stations:stationList});this.setState({hasLoaded:true});console.log(\"updated station status\");}},{key:\"getStationDayLog\",value:function getStationDayLog(stationID){var _this4=this;fetch(\"stationlog/\".concat(stationID)).then(function(res){return res.json();}).then(function(data){return _this4.setStationDayLog(data,stationID);});// console.log(\"updated station \"+stationID+\" logs\")\n}},{key:\"setStationDayLog\",value:function setStationDayLog(data,stationID){this.setState(function(prevState){return{dayLog:_objectSpread({},prevState.dayLog,_defineProperty({},stationID,data.stationLog))};});}},{key:\"getStationWeekLog\",value:function getStationWeekLog(stationID){var _this5=this;fetch(\"stationlogweek/\".concat(stationID)).then(function(res){return res.json();}).then(function(data){return _this5.setStationWeekLog(data,stationID);});}},{key:\"setStationWeekLog\",value:function setStationWeekLog(data,stationID){this.setState(function(prevState){return{weekLog:_objectSpread({},prevState.weekLog,_defineProperty({},stationID,data.stationLog))};});// console.log(this.state.weekLog[stationID])\n}},{key:\"handleMapLocationChange\",value:function(){var _handleMapLocationChange=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(lat,lon){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return this.setState(function(prevState){return{selectedLocation:\"Custom Location\",selectedLocationLatitude:lat.toFixed(5),selectedLocationLongitude:lon.toFixed(5),numStations:10,stations:[],initialBikeCount:{},status:{},showInfo:{},dayLog:{},weekLog:{},hasLoaded:false,mapStation:null,loadTime:null,updateTime:null,mapClickTime:null,timeSinceUpdate:null,timeSinceLoad:null,timeSinceMapClick:null};});case 2:this.getStationStatus();case 3:case\"end\":return _context.stop();}}},_callee,this);}));function handleMapLocationChange(_x,_x2){return _handleMapLocationChange.apply(this,arguments);}return handleMapLocationChange;}()},{key:\"handleLocationChange\",value:function(){var _handleLocationChange=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(name){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return this.setState(function(prevState){return{selectedLocation:name,selectedLocationLatitude:prevState.locationCoordinates[name].latitude,selectedLocationLongitude:prevState.locationCoordinates[name].longitude,numStations:10,stations:[],initialBikeCount:{},status:{},showInfo:{},dayLog:{},weekLog:{},hasLoaded:false,mapStation:null,loadTime:null,updateTime:null,mapClickTime:null,timeSinceUpdate:null,timeSinceLoad:null,timeSinceMapClick:null};});case 2:this.getStationStatus();case 3:case\"end\":return _context2.stop();}}},_callee2,this);}));function handleLocationChange(_x3){return _handleLocationChange.apply(this,arguments);}return handleLocationChange;}()},{key:\"handleMapToggle\",value:function handleMapToggle(){this.setState(function(prevState){return{showMap:!prevState.showMap};});}},{key:\"handleMapClick\",value:function(){var _handleMapClick=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(event,id){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return this.setState(function(prevState){return{mapStation:id,mapClickTime:Date.now(),showInfo:_objectSpread({},prevState.showInfo,_defineProperty({},id,true))};});case 2:this.getStationDayLog(id);this.getStationWeekLog(id);case 4:case\"end\":return _context3.stop();}}},_callee3,this);}));function handleMapClick(_x4,_x5){return _handleMapClick.apply(this,arguments);}return handleMapClick;}()},{key:\"handleShowChange\",value:function(){var _handleShowChange=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(id){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return this.setState(function(prevState){var newShow=!prevState.showInfo[id];return{showInfo:_objectSpread({},prevState.showInfo,_defineProperty({},id,newShow))};});case 2:this.getStationDayLog(id);this.getStationWeekLog(id);case 4:case\"end\":return _context4.stop();}}},_callee4,this);}));function handleShowChange(_x6){return _handleShowChange.apply(this,arguments);}return handleShowChange;}()},{key:\"loadMoreStations\",value:function(){var _loadMoreStations=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return this.setState(function(prevState){return{numStations:prevState.numStations+10};});case 2:this.getStationStatus();case 3:case\"end\":return _context5.stop();}}},_callee5,this);}));function loadMoreStations(){return _loadMoreStations.apply(this,arguments);}return loadMoreStations;}()},{key:\"updateWindowDimensions\",value:function updateWindowDimensions(){this.setState(function(prevState){var nextShowMap=prevState.showMap||prevState.view!==\"Desktop\"&&window.innerWidth>820;return{windowWidth:window.innerWidth,windowHeight:window.innerHeight,view:window.innerWidth>820?\"Desktop\":\"Mobile\",showMap:nextShowMap};});}},{key:\"componentDidMount\",value:function componentDidMount(){var _this6=this;this.updateWindowDimensions();window.addEventListener('resize',this.updateWindowDimensions);this.setState({showMap:window.innerWidth>820?true:false});this.getStationStatus();setInterval(function(){return _this6.setState(function(prevState){return{timeSinceUpdate:Date.now()-prevState.updateTime,timeSinceLoad:Date.now()-prevState.loadTime};});},100);setInterval(function(){return _this6.setState(function(prevState){return{timeSinceMapClick:Date.now()-prevState.mapClickTime};});},10);setInterval(function(){return _this6.getStationStatus();},30000);}},{key:\"render\",value:function render(){if(this.state.view===\"Desktop\"){return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Header,this.state),/*#__PURE__*/React.createElement(Desktop,Object.assign({},this.state,{handleLocationChange:this.handleLocationChange,handleMapClick:this.handleMapClick,handleMapLocationChange:this.handleMapLocationChange,handleMapToggle:this.handleMapToggle,handleShowChange:this.handleShowChange,loadMoreStations:this.loadMoreStations})),/*#__PURE__*/React.createElement(Footer,this.state));}else{return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Header,this.state),/*#__PURE__*/React.createElement(\"div\",{style:{width:\"min(90vw,800px)\",margin:\"auto\"}},/*#__PURE__*/React.createElement(Dashboard,Object.assign({},this.state,{handleLocationChange:this.handleLocationChange,handleMapClick:this.handleMapClick,handleMapLocationChange:this.handleMapLocationChange,handleMapToggle:this.handleMapToggle})),/*#__PURE__*/React.createElement(Stations,Object.assign({},this.state,{handleShowChange:this.handleShowChange,loadMoreStations:this.loadMoreStations}))),/*#__PURE__*/React.createElement(Footer,this.state));}}}]);return App;}(React.Component);export default App;","map":{"version":3,"sources":["/Users/keny/Desktop/Programming/Bikeable/frontend/src/App.js"],"names":["React","Header","Dashboard","Stations","Footer","Desktop","App","state","selectedLocation","selectedLocationLatitude","selectedLocationLongitude","locationCoordinates","latitude","longitude","numStations","time","date","weather","temperature","stations","initialBikeCount","status","showInfo","dayLog","weekLog","hasLoaded","showMap","mapStation","loadTime","updateTime","mapClickTime","timeSinceUpdate","timeSinceLoad","timeSinceMapClick","windowHeight","windowWidth","view","getStationStatus","bind","setStationStatus","getStationDayLog","setStationDayLog","getStationWeekLog","setStationWeekLog","handleMapLocationChange","handleLocationChange","handleMapToggle","handleMapClick","handleShowChange","loadMoreStations","updateWindowDimensions","fetch","then","res","json","data","stationList","stationStatus","map","station","id","setState","Date","now","weatherTemperature","weatherDescription","stationI","prevState","bikes","length","console","log","stationID","stationLog","lat","lon","toFixed","name","event","newShow","nextShowMap","window","innerWidth","innerHeight","addEventListener","setInterval","width","margin","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport './App.css';\n\nimport Header from \"./components/Header\"\nimport Dashboard from \"./components/Dashboard\"\nimport Stations from \"./components/Stations\"\nimport Footer from \"./components/Footer\"\n\n\nimport Desktop from \"./components/Desktop\"\n\nclass App extends React.Component{\n  constructor(){\n    super()\n    this.state = {\n\n      selectedLocation:\"Union Square Park\",\n      selectedLocationLatitude:40.7359,\n      selectedLocationLongitude:-73.9911,\n      locationCoordinates:{\n        \"Washington Square Park\":{latitude :40.7308,longitude:-73.9973},\n        \"Union Square Park\":{latitude:40.7359, longitude:-73.9911},\n        \"Times Square\":{latitude:40.7580,longitude:-73.9911},\n        \"Bowling Green\":{latitude:40.7050, longitude:-74.0137},\n        \"The MET\":{latitude:40.7794, longitude:-73.9632},\n        \"Penn Station\":{latitude:40.7506,longitude:-73.9935},\n      },\n      numStations:10,\n\n      time:\"\",\n      date:\"\",\n      weather:\"\",\n      temperature:\"\",\n\n      stations:[],\n      initialBikeCount:{},\n      status:{},\n      showInfo:{},\n      dayLog :{},\n      weekLog :{},\n      \n      hasLoaded:false,\n\n      showMap:false,\n      mapStation:null,\n      \n      loadTime: null,\n      updateTime :null,\n      mapClickTime:null,\n      timeSinceUpdate:null,\n      timeSinceLoad:null,\n      timeSinceMapClick:null,\n\n      windowHeight:0,\n      windowWidth:0,\n      view:null\n\n      \n    }\n    this.getStationStatus = this.getStationStatus.bind(this);\n    this.setStationStatus = this.setStationStatus.bind(this);\n\n    this.getStationDayLog = this.getStationDayLog.bind(this);\n    this.setStationDayLog = this.setStationDayLog.bind(this);\n\n    this.getStationWeekLog = this.getStationWeekLog.bind(this);\n    this.setStationWeekLog = this.setStationWeekLog.bind(this);\n\n    this.handleMapLocationChange = this.handleMapLocationChange.bind(this);\n    this.handleLocationChange = this.handleLocationChange.bind(this);\n    this.handleMapToggle = this.handleMapToggle.bind(this);\n    this.handleMapClick = this.handleMapClick.bind(this);\n    this.handleShowChange = this.handleShowChange.bind(this);\n    this.loadMoreStations = this.loadMoreStations.bind(this);\n\n    this.updateWindowDimensions = this.updateWindowDimensions.bind(this);\n  }\n\n  getStationStatus(){\n    fetch(`stationstatus/${this.state.numStations}/${this.state.selectedLocationLatitude},${this.state.selectedLocationLongitude}`).then(res=>res.json()).then(data=>(\n      this.setStationStatus(data)\n    ))\n    \n  }\n\n  setStationStatus(data){\n\n    let stationList = data.stationStatus.map(station=>{return station.id})\n    \n    if (!this.state.loadTime){\n      this.setState({ \n        loadTime:Date.now()\n       });\n\n     }\n\n     this.setState({\n      updateTime: Date.now(),\n      date:data.date,\n      time: data.time,\n      temperature:data.weatherTemperature,\n      weather: data.weatherDescription\n      \n    })\n         \n\n     for (let stationI = 0; stationI < stationList.length; stationI++){\n      this.setState(prevState=>({ \n        status:{\n          ...prevState.status,\n          [stationList[stationI]]:data.stationStatus[stationI]\n          \n        }\n       }));\n      \n       if (!(stationList[stationI] in this.state.initialBikeCount)){\n        this.setState(prevState=>({ \n          showInfo:{\n            ...prevState.showInfo,\n            [stationList[stationI]]:false\n          },\n          initialBikeCount:{\n            ...prevState.initialBikeCount,\n            [stationList[stationI]]:this.state.status[stationList[stationI]].bikes\n          },\n\n          }));\n      }\n      //  this.getStationDayLog(stationList[stationI])\n      //  this.getStationWeekLog(stationList[stationI])       \n     }\n     this.setState({\n      stations:stationList\n\n    })\n     \n     this.setState({ \n      hasLoaded:true\n     });\n     console.log(\"updated station status\")\n  }\n\n  getStationDayLog(stationID){\n    fetch(`stationlog/${stationID}`).then(res=>res.json()).then(data=>(\n      this.setStationDayLog(data,stationID)\n    ))\n    // console.log(\"updated station \"+stationID+\" logs\")\n  }\n\n  setStationDayLog(data,stationID){\n\n      this.setState(prevState=>({\n        dayLog:{\n          ...prevState.dayLog,\n          [stationID]:data.stationLog\n        }\n      }))\n    \n  }\n\n  getStationWeekLog(stationID){\n    fetch(`stationlogweek/${stationID}`).then(res=>res.json()).then(data=>(\n      this.setStationWeekLog(data,stationID)\n    ))\n  }\n\n  setStationWeekLog(data,stationID){\n\n      this.setState(prevState=>({\n        weekLog:{\n          ...prevState.weekLog,\n          [stationID]:data.stationLog\n        }\n      }))\n      // console.log(this.state.weekLog[stationID])\n    \n  }\n\n  async handleMapLocationChange(lat,lon){\n    await this.setState( prevState=>({\n      selectedLocation: \"Custom Location\",\n      selectedLocationLatitude:lat.toFixed(5),\n      selectedLocationLongitude:lon.toFixed(5),\n\n      numStations:10,\n      stations:[],\n      initialBikeCount:{},\n      status:{},\n      showInfo:{},\n      dayLog :{},\n      weekLog :{},\n      \n      hasLoaded:false,\n\n\n      mapStation:null,\n      \n      loadTime: null,\n      updateTime :null,\n      mapClickTime:null,\n      timeSinceUpdate:null,\n      timeSinceLoad:null,\n      timeSinceMapClick:null,\n    }))\n    this.getStationStatus()\n\n  }\n\n  async handleLocationChange(name){\n    await this.setState( prevState=>({\n      selectedLocation: name,\n      selectedLocationLatitude:prevState.locationCoordinates[name].latitude,\n      selectedLocationLongitude:prevState.locationCoordinates[name].longitude,\n      numStations:10,\n      stations:[],\n      initialBikeCount:{},\n      status:{},\n      showInfo:{},\n      dayLog :{},\n      weekLog :{},\n      \n      hasLoaded:false,\n\n      mapStation:null,\n      \n      loadTime: null,\n      updateTime :null,\n      mapClickTime:null,\n      timeSinceUpdate:null,\n      timeSinceLoad:null,\n      timeSinceMapClick:null,\n    }))\n    this.getStationStatus()\n  }\n\n  handleMapToggle(){\n    this.setState( prevState =>(\n      {showMap:!prevState.showMap}\n     ))\n  }\n\n  async handleMapClick(event,id){\n    await this.setState( prevState=>({\n        mapStation:id,\n        mapClickTime:Date.now(),\n        showInfo:{\n          ...prevState.showInfo,\n          [id]:true\n        } }\n      \n\n    ))\n    this.getStationDayLog(id)\n    this.getStationWeekLog(id) \n    \n  }\n\n  async handleShowChange(id){\n    await this.setState( prevState =>{\n      const newShow = !prevState.showInfo[id]\n      return { \n      showInfo:{\n        ...prevState.showInfo,\n        [id]:newShow\n      }\n     }})\n    this.getStationDayLog(id)\n    this.getStationWeekLog(id)   \n  }\n\n  async loadMoreStations(){\n    await this.setState(prevState=>({\n      numStations: prevState.numStations+10\n    }))\n    this.getStationStatus()\n  }\n\n  updateWindowDimensions() {\n    this.setState(prevState=>{\n      const nextShowMap = prevState.showMap || (prevState.view!==\"Desktop\"&&window.innerWidth>820);\n      return {\n        windowWidth: window.innerWidth, \n      windowHeight: window.innerHeight,\n      view:window.innerWidth>820?\"Desktop\":\"Mobile\",\n      showMap:nextShowMap\n    }});\n    \n      \n     \n  }\n\n  componentDidMount() {\n    this.updateWindowDimensions();\n    window.addEventListener('resize', this.updateWindowDimensions);\n    this.setState({showMap:window.innerWidth>820?true:false})\n    this.getStationStatus()\n    setInterval(() => this.setState(prevState=>({ timeSinceUpdate: Date.now()-prevState.updateTime,timeSinceLoad:Date.now()-prevState.loadTime})), 100)\n    setInterval(() => this.setState(prevState=>({timeSinceMapClick:Date.now()-prevState.mapClickTime})), 10)\n    setInterval(() => this.getStationStatus(), 30000)\n    \n      \n  }\n\n  render(){\n    if (this.state.view===\"Desktop\"){return (\n      <div>\n        <Header {...this.state}/>\n        <Desktop {...this.state} handleLocationChange = {this.handleLocationChange} handleMapClick = {this.handleMapClick} handleMapLocationChange = {this.handleMapLocationChange} handleMapToggle = {this.handleMapToggle} handleShowChange = {this.handleShowChange} loadMoreStations = {this.loadMoreStations}/>\n        <Footer {...this.state}/>\n        \n      </div>\n    );}\n    else{return(\n      <div>\n        <Header {...this.state}/>\n        <div style={{width:\"min(90vw,800px)\",margin:\"auto\"}}>\n        <Dashboard{...this.state} handleLocationChange = {this.handleLocationChange} handleMapClick = {this.handleMapClick} handleMapLocationChange = {this.handleMapLocationChange}  handleMapToggle = {this.handleMapToggle}/>\n        <Stations{...this.state} handleShowChange = {this.handleShowChange} loadMoreStations = {this.loadMoreStations}/>\n        </div>\n        <Footer {...this.state}/>\n      </div>\n    )\n      \n    }\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}